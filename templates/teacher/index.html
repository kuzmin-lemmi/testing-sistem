{% extends "teacher/base.html" %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - –ï–ì–≠ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞{% endblock %}

{% block content %}
<div class="dashboard">
    <h1>üéì –°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ï–ì–≠ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ</h1>
    
    <div class="server-info card">
        <h2>üåê –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ</h2>
        <div class="server-details">
            <div class="info-row">
                <span class="label">–ê–¥—Ä–µ—Å –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤:</span>
                <code class="server-url">http://{{ local_ip }}:{{ port }}/test</code>
                <button class="btn btn-small" onclick="copyUrl()" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3);">
                    üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                </button>
            </div>
            <div class="info-row">
                <span class="label">–°—Ç–∞—Ç—É—Å:</span>
                <span class="status-badge status-active">üü¢ –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω</span>
            </div>
        </div>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">{{ total_tasks }}</div>
            <div class="stat-label">–ó–∞–¥–∞—á –≤ –±–∞–Ω–∫–µ</div>
            <a href="{{ url_for('tasks_list') }}" class="stat-link">–ü–µ—Ä–µ–π—Ç–∏ ‚Üí</a>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ variants_count }}</div>
            <div class="stat-label">–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</div>
            <a href="{{ url_for('variants_list') }}" class="stat-link">–ü–µ—Ä–µ–π—Ç–∏ ‚Üí</a>
        </div>
        <div class="stat-card">
            <div class="stat-number">{{ task_counts|length }}<span style="font-size: 0.5em; color: var(--text-muted);">/27</span></div>
            <div class="stat-label">–ù–æ–º–µ—Ä–æ–≤ –ï–ì–≠ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ</div>
            <span class="stat-sublabel">–∏–∑ 27 –≤–æ–∑–º–æ–∂–Ω—ã—Ö</span>
        </div>
    </div>
    
    <div class="quick-actions card">
        <h2>‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h2>
        <div class="action-buttons">
            <a href="{{ url_for('task_add') }}" class="btn btn-primary">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</a>
            <a href="{{ url_for('variant_create') }}" class="btn btn-secondary">üìã –°–æ–∑–¥–∞—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç</a>
            <a href="{{ url_for('session_new') }}" class="btn btn-success">‚ñ∂Ô∏è –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</a>
        </div>
    </div>
    
    <div class="tasks-overview card">
        <h2>üìä –ó–∞–¥–∞—á–∏ –ø–æ –Ω–æ–º–µ—Ä–∞–º –ï–ì–≠</h2>
        <div class="ege-grid">
            {% for num in range(1, 28) %}
            <a href="{{ url_for('tasks_list', ege=num) }}" class="ege-cell {% if task_counts.get(num, 0) == 0 %}empty{% endif %}">
                <span class="ege-number">{{ num }}</span>
                <span class="ege-count">{{ task_counts.get(num, 0) }} —à—Ç.</span>
            </a>
            {% endfor %}
        </div>
    </div>
</div>

<script>
function copyUrl() {
    const url = document.querySelector('.server-url').textContent;
    navigator.clipboard.writeText(url).then(() => {
        const btn = event.target;
        const originalText = btn.innerHTML;
        btn.innerHTML = '‚úì –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
        setTimeout(() => {
            btn.innerHTML = originalText;
        }, 2000);
    });
}
</script>
{% endblock %}
